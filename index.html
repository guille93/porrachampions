<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Porra Champions 25-26</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="app-header">
    <div class="container header-row">
      <div>
        <h1>Porra Champions 2025‚Äì2026</h1>
        <p class="muted" id="metaLine">Cargando datos‚Ä¶</p>
        <div class="meta-chips">
          <span class="pill">üíæ Guardado autom√°tico</span>
          <span class="pill">üåê Sin servidor</span>
          <span class="pill">‚ö° Datos en tiempo real</span>
        </div>
      </div>

      <div class="header-actions">
        <button class="btn" id="btnExport">‚¨áÔ∏è Exportar estado</button>
        <button class="btn" id="btnImport">‚¨ÜÔ∏è Importar estado</button>
        <button class="btn btn-ghost" id="btnReset">‚ôªÔ∏è Restaurar datos de Excel</button>
      </div>
    </div>

    <nav class="tabs">
      <div class="container tab-row" role="tablist" aria-label="Secciones">
        <button class="tab active" data-view="league" role="tab" aria-selected="true">üèÜ League</button>
        <button class="tab" data-view="admin" role="tab" aria-selected="false">üõ†Ô∏è Admin</button>
        <button class="tab" data-view="clas" role="tab" aria-selected="false">üìä Clas</button>
      </div>
    </nav>
  </header>

  <main class="container">
    <section id="view-league" class="view active" aria-label="League">
      <div class="panel intro">
        <div>
          <h2>Empieza por aqu√≠</h2>
          <p class="muted">
            Filtra los partidos, actualiza resultados reales y revisa la clasificaci√≥n al instante. Usa la b√∫squeda r√°pida para encontrar equipos o
            placeholders.
          </p>
        </div>
        <div class="intro-actions">
          <div class="hint-card">
            <span class="hint-title">Consejo r√°pido</span>
            <span class="muted small">Los cambios se guardan autom√°ticamente en tu navegador.</span>
          </div>
        </div>
      </div>
      <div class="panel">
        <div class="panel-head">
          <h2>Partidos</h2>
          <div class="filters">
            <label class="field">
              <span>Fase</span>
              <select id="leagueStageFilter"></select>
            </label>

            <label class="field">
              <span>Estado</span>
              <select id="leaguePlayedFilter">
                <option value="all">Todos</option>
                <option value="played">Jugados</option>
                <option value="upcoming">Pr√≥ximos</option>
              </select>
            </label>

            <label class="field grow">
              <span>Buscar</span>
              <input id="leagueSearch" type="search" placeholder="Equipo o placeholder (p.ej., Arsenal, WPO1)‚Ä¶" />
            </label>
          </div>
        </div>

        <div class="table-wrap">
          <table class="table" id="matchesTable">
            <thead>
              <tr>
                <th>Fecha</th>
                <th>Fase</th>
                <th>Partido</th>
                <th class="center">Resultado real</th>
                <th class="right">Acci√≥n</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>

        <div class="note muted">
          El estado se guarda en tu navegador (localStorage). Si adem√°s creas/actualizas un archivo <code>state.json</code> en el repo, la web lo cargar√° autom√°ticamente para todos.
        </div>
      </div>

      <div class="panel">
        <div class="panel-head">
          <h2>Clasificaci√≥n fase de liga (equipos)</h2>
          <div class="muted small">Calculada a partir de los resultados reales introducidos.</div>
        </div>

        <div class="table-wrap">
          <table class="table" id="standingsTable">
            <thead>
              <tr>
                <th class="center">Pos</th>
                <th>Equipo</th>
                <th class="center">Pts</th>
                <th class="center">J</th>
                <th class="center">G</th>
                <th class="center">E</th>
                <th class="center">P</th>
                <th class="center">GF</th>
                <th class="center">GC</th>
                <th class="center">DG</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </section>

    <section id="view-admin" class="view" aria-label="Admin">
      <div class="panel">
        <div class="panel-head">
          <h2>Pron√≥sticos por partido</h2>
          <div class="filters">
            <label class="field">
              <span>Jugador</span>
              <select id="adminPlayerFilter"></select>
            </label>

            <label class="field">
              <span>Fase</span>
              <select id="adminStageFilter"></select>
            </label>

            <label class="field grow">
              <span>Buscar</span>
              <input id="adminSearch" type="search" placeholder="Partido, equipo o placeholder‚Ä¶" />
            </label>
          </div>
        </div>

        <div class="table-wrap">
          <table class="table" id="adminMatchesTable">
            <thead>
              <tr>
                <th>Fecha</th>
                <th>Fase</th>
                <th>Partido</th>
                <th class="center">Real</th>
                <th class="center">Pron√≥stico</th>
                <th class="center">Puntos</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>

      <div class="panel">
        <div class="panel-head">
          <h2>Predicciones adicionales</h2>
          <div class="muted small">Seg√∫n la hoja ADMIN: posiciones de liga, equipos a 1/8 (desde liga) y equipos de playoffs.</div>
        </div>

        <div class="grid-2">
          <div class="card">
            <h3>Posici√≥n final (1‚Äì36)</h3>
            <div class="muted small">Puntos por posici√≥n exacta: <span id="posPoints"></span></div>
            <div class="table-wrap">
              <table class="table compact" id="positionsTable">
                <thead>
                  <tr>
                    <th class="center">Pos</th>
                    <th>Selecci√≥n</th>
                    <th class="center">Puntos</th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
          </div>

          <div class="card">
            <h3>Equipos a Octavos (desde Liga)</h3>
            <div class="muted small">Puntos por equipo: <span id="octPoints"></span></div>
            <div class="table-wrap">
              <table class="table compact" id="octavosTable">
                <thead>
                  <tr>
                    <th>Slot</th>
                    <th>Selecci√≥n</th>
                    <th class="center">Puntos</th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>

            <div class="spacer"></div>

            <h3>Equipos de Playoffs</h3>
            <div class="muted small">Puntos por equipo: <span id="poTeamPoints"></span></div>
            <div class="table-wrap">
              <table class="table compact" id="playoffsTeamsTable">
                <thead>
                  <tr>
                    <th>Slot</th>
                    <th>Selecci√≥n</th>
                    <th class="center">Puntos</th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>

            <details class="muted small">
              <summary>Activar puntuaci√≥n de estas secciones</summary>
              En el Excel, estos apartados punt√∫an cuando se conocen los resultados ‚Äúreales‚Äù (posiciones finales y equipos clasificados).
              Aqu√≠ se activan rellenando los <em>actuales</em> en <code>state.json</code> (o importando un estado) en el bloque <code>picksActual</code>.
            </details>
          </div>
        </div>
      </div>
    </section>

    <section id="view-clas" class="view" aria-label="Clas">
      <div class="panel">
        <div class="panel-head">
          <h2>Clasificaci√≥n (amigos)</h2>
          <div class="filters">
            <label class="field">
              <span>Orden</span>
              <select id="clasSort">
                <option value="points">Puntos (desc)</option>
                <option value="name">Nombre (A‚ÄìZ)</option>
              </select>
            </label>
          </div>
        </div>

        <div class="table-wrap">
          <table class="table" id="clasTable">
            <thead>
              <tr>
                <th class="center">#</th>
                <th>Jugador</th>
                <th class="center">Puntos</th>
                <th class="center">Desglose</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>

        <div class="note muted">
          Puntuaci√≥n por partido (como en el Excel): puntos por signo + bonus por exacto.
        </div>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="container muted small">
      Sin servidor. Apto para GitHub Pages. Fuente: <code>data.json</code> + (opcional) <code>state.json</code>.
    </div>
  </footer>

  <dialog id="dlgMatch">
    <form method="dialog" class="dialog">
      <div class="dialog-head">
        <h3 id="dlgTitle">Editar resultado</h3>
        <button class="icon-btn" value="cancel" aria-label="Cerrar">√ó</button>
      </div>

      <div class="dialog-body">
        <div class="row">
          <label class="field">
            <span>Goles local</span>
            <input id="dlgHome" inputmode="numeric" pattern="\d*" placeholder="-" />
          </label>
          <div class="vs">‚Äì</div>
          <label class="field">
            <span>Goles visitante</span>
            <input id="dlgAway" inputmode="numeric" pattern="\d*" placeholder="-" />
          </label>
        </div>

        <div class="muted small" id="dlgHint"></div>
      </div>

      <div class="dialog-actions">
        <button class="btn btn-ghost" value="cancel">Cancelar</button>
        <button class="btn" id="dlgSave" value="default">Guardar</button>
      </div>
    </form>
  </dialog>

  <input id="fileImport" type="file" accept="application/json" hidden />

  <script src="app.js"></script>
</body>
</html>
